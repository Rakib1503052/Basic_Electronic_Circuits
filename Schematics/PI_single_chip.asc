Version 4
SHEET 1 1304 680
WIRE 432 -96 416 -96
WIRE 528 -96 512 -96
WIRE -32 0 -48 0
WIRE 32 0 -32 0
WIRE 176 0 112 0
WIRE 256 0 176 0
WIRE 416 0 416 -96
WIRE 416 0 336 0
WIRE 432 0 416 0
WIRE 528 0 528 -96
WIRE 528 0 496 0
WIRE -32 48 -32 0
WIRE -416 112 -416 96
WIRE 272 128 272 112
WIRE 176 144 176 0
WIRE 240 144 176 144
WIRE 528 160 528 0
WIRE 528 160 304 160
WIRE 560 160 528 160
WIRE -32 176 -32 128
WIRE -32 176 -48 176
WIRE 32 176 -32 176
WIRE 176 176 112 176
WIRE 240 176 176 176
WIRE -416 224 -416 192
WIRE 176 224 176 176
WIRE 272 224 272 192
WIRE 176 320 176 304
WIRE 176 320 112 320
WIRE 112 336 112 320
WIRE 176 352 176 320
WIRE 112 432 112 416
WIRE 176 432 176 416
WIRE 176 432 112 432
WIRE 176 448 176 432
FLAG -416 224 0
FLAG -416 96 Vdd
IOPIN -416 96 Out
FLAG 272 112 Vdd
IOPIN 272 112 In
FLAG 176 448 0
FLAG 560 160 CMD
IOPIN 560 160 Out
FLAG -48 176 Set
IOPIN -48 176 In
FLAG -48 0 FB
IOPIN -48 0 In
FLAG 272 224 0
SYMBOL voltage -416 96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL res 128 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value {Rp1}
SYMBOL res 352 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {Rp2}
SYMBOL res 128 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value {Rp1}
SYMBOL res 192 320 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value {Rp2}
SYMBOL cap 160 352 R0
SYMATTR InstName C2
SYMATTR Value {Cp}
SYMBOL cap 496 -16 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {Cp}
SYMBOL voltage -32 32 R0
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 20 17 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value ""
SYMATTR Value2 AC 1
SYMBOL res 528 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100Meg
SYMBOL res 128 320 M0
SYMATTR InstName R6
SYMATTR Value 100Meg
SYMBOL OpAmps\\AD8655 272 96 R0
SYMATTR InstName U1
TEXT 328 288 Left 2 !.param Rp1=10k Rp2=10k Cp=100n
TEXT 328 336 Left 2 !.ac dec 50 1 1Meg
TEXT -48 -344 Left 4 ;PI controller using a single op-amp\nTransfer function = Kp(1+1/Ti.s)
TEXT -584 -232 Left 2 ;I first saw the circuit diagram on a forum\nbut cannot find the thread anymore\nThis circuit implements a PI control using\na single op-amp only. It can work with both\nsingle rail and split rail.\nThis implementation is beneficial for small\nsingle rail systems.
TEXT 600 -232 Left 2 ;R1 = R2, R3 = R4, R5 = R6, C1 = C2\nV_out = (Rp2/Rp1)V_e + (1/Rp1Cp)Int(V_e)\nwhere V_e = V_set - V_fb\nKp = Rp2/Rp1, Ki = 1/Rp1Cp, Ti = Rp2Cp
